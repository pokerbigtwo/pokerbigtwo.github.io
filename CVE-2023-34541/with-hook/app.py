from  langchain . prompts  import  load_prompt 
from jinja2 import Template
from flask import Flask

import sys

def hook(evt, arg):
    if evt in ["sys._getframe", "object.__getattr__", "object.__setattr__"]:
        return
    frame = sys._getframe(0)
    f = frame.f_code.co_filename
    
    while frame:
        if frame.f_back is None:
            break
        else:
            frame = frame.f_back
        
        func_name = frame.f_code.co_name
        if frame.f_code.co_filename == f:

            if func_name == "hello_world":
                if evt not in ['open']:
                    raise RuntimeError('Event not allowed')
                
sys.addaudithook(hook)

app = Flask(__name__)

@app.route('/')
def hello_world():
    loaded_prompt = load_prompt ( "system.py" )
    t = Template("Hello")
    return t.render()

if __name__ == '__main__':
    app.run(host="0.0.0.0",port=5000)
    
    